<?phprequire_once "Project/ApplicationsFramework/MVC_superClasses/applicationsSuperController.php";require_once "authenticateView.php";require_once "Project/Model/Settings/settings.php";require_once "Project/2_Enterprise/Code/Modules/userSession.php";require_once "Project/2_Enterprise/Code/Modules/mailer.php";class authenticateController extends applicationsSuperController{	public function loginAction()	{		if (isset($_POST["login"]))		{			$username = $_POST["username"];			$password = sha1(md5($_POST["password"]));						$credentials = settings::selectLogin($username, $password);						if($credentials)			{				$user_account["role"]     = "admin";				$user_account["user_id"]  = $credentials["settings_id"];				$user_account["username"] = $credentials["username"];				userSession::saveSession($user_account);				header("Location: /");			}			else			{				header("Location: /?error=1");			}		}		else		{			header("Location: /");		}	}		//-------------------------------------------------------------------------------------------------		public function logoutAction()	{		userSession::unsetSession();		header("Location: /");	}		//-------------------------------------------------------------------------------------------------		public function forgotAction()	{		if(isset($_POST["email"]))		{			$settings = new settings();			$settings->__set("to_email", $_POST["email"]);			$user = $settings->selectByEmail();						if($user)			{				$new_password = uniqid().rand(1, 100);				$settings->updateOneColumn("password", sha1(md5($new_password)));								$body = "					Hi, <br />					Your new password is: $new_password				";								mailer::send_with_phpmailer(array("email" => $_POST["email"]), "Enterprise New Password", $body);								header("Location: ?forgot=true&error=0");			}			else			{				header("Location: ?forgot=true&error=1");			}		}	}	}